/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, ViewChild, ElementRef, Input, Output, EventEmitter, ChangeDetectionStrategy, ChangeDetectorRef, ViewEncapsulation } from '@angular/core';
import { NG_VALUE_ACCESSOR } from '@angular/forms';
import { DatepickerService } from './datepicker.service';
export class DatepickerComponent {
    /**
     * @param {?} datePickerService
     * @param {?} changeDetect
     */
    constructor(datePickerService, changeDetect) {
        this.datePickerService = datePickerService;
        this.changeDetect = changeDetect;
        this.position = 'bottom';
        this.dateFormat = 'DD-MMM-YYYY';
        this.pickerHeight = 500;
        this.onDateSelect = new EventEmitter();
        this.inputOffset = 26;
        this.positioned = false;
        this.hide = true;
        this.myInput = '';
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.items = ['S', 'M', 'T', 'W', 'T', 'F', 'S'];
        this.months = this.datePickerService.getMonths();
        this.years = this.datePickerService.getYears();
        this.year = this.datePickerService.getYear();
        this.month = this.datePickerService.getMonth();
        this.genCalendarView();
        document.body.appendChild(this.pickerCompRef.nativeElement);
        this.detectChanges();
    }
    /**
     * @return {?}
     */
    positionBody() {
        if (!this.positioned) {
            this.positionElement();
        }
        this.openPicker();
    }
    /**
     * This is where the values updated in view in parent component gets updated in the child component here
     * @param {?} myInput
     * @return {?}
     */
    writeValue(myInput) {
        this.myInput = myInput;
        this.detectChanges();
    }
    /**
     * @param {?} fn
     * @return {?}
     */
    registerOnChange(fn) {
        this.onChange = fn;
    }
    /**
     * @param {?} fn
     * @return {?}
     */
    registerOnTouched(fn) {
        this.onBlur = fn;
    }
    /**
     * @return {?}
     */
    positionElement() {
        /** @type {?} */
        let dropdownItem = this.pickerCompRef.nativeElement;
        dropdownItem['style']['top'] = this.elementTop + 'px';
        dropdownItem['style']['left'] = this.elementLeft + 'px';
        this.positioned = true;
    }
    /**
     * @return {?}
     */
    getPosition() {
        /** @type {?} */
        let rect = this.pickerInput.nativeElement.getBoundingClientRect();
        /** @type {?} */
        let scrollTop = document.documentElement.scrollTop ?
            document.documentElement.scrollTop : document.body.scrollTop;
        /** @type {?} */
        let scrollLeft = document.documentElement.scrollLeft ?
            document.documentElement.scrollLeft : document.body.scrollLeft;
        this.elementTop = rect.top + scrollTop;
        this.elementLeft = rect.left + scrollLeft;
        switch (this.position) {
            case 'left':
                this.elementLeft -= 300;
                this.elementTop -= this.inputOffset - 20;
                break;
            case 'right':
                this.elementLeft += 200;
                this.elementTop -= this.inputOffset - 20;
                break;
            case 'top':
                this.elementTop -= 273;
                break;
            case 'bottom':
            default:
                this.elementTop += this.inputOffset;
                break;
        }
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        this.pickerCompRef.nativeElement.outerHTML = '';
    }
    /**
     * @param {?} day
     * @return {?}
     */
    onDateSelection(day) {
        if (day < 10) {
            day = '0' + day;
        }
        /** @type {?} */
        let month = this.month;
        if (this.month < 10) {
            month = '0' + this.month;
        }
        /** @type {?} */
        let selectedDate = this.year + '-' + month + '-' + day;
        /** @type {?} */
        let dateObj = {
            formattedDate: this.datePickerService.getDateFormatted(selectedDate, this.dateFormat),
            dateObject: this.datePickerService.getDateMoment(selectedDate)
        };
        this.myInput = dateObj.formattedDate;
        this.onChange(this.myInput);
        this.onDateSelect.emit(dateObj.dateObject);
        this.closePicker();
    }
    /**
     * @return {?}
     */
    genCalendarView() {
        try {
            /** @type {?} */
            let startDay = this.datePickerService.generateMonthDate(this.month, this.year);
            /** @type {?} */
            let lastDay = this.datePickerService.getMonthDates(this.month, this.year);
            try {
                this.dateComposer = this.datePickerService.dateComposer(startDay, lastDay);
                this.detectChanges();
            }
            catch (e) {
                console.error(e);
            }
        }
        catch (e) {
            console.error(e);
        }
    }
    /**
     * @return {?}
     */
    gotoPrevMonth() {
        if (Number(this.month) === 1) {
            this.month = 12;
            this.year--;
        }
        else {
            this.month--;
        }
    }
    /**
     * @return {?}
     */
    gotoNextMonth() {
        if (Number(this.month) === 12) {
            this.month = 1;
            this.year++;
        }
        else {
            this.month++;
        }
    }
    /**
     * @return {?}
     */
    openPicker() {
        this.hide = false;
        this.detectChanges();
    }
    /**
     * @return {?}
     */
    closePicker() {
        this.hide = true;
        this.detectChanges();
    }
    /**
     * @return {?}
     */
    detectChanges() {
        this.changeDetect.detectChanges();
    }
}
DatepickerComponent.decorators = [
    { type: Component, args: [{
                selector: 'anglar-datepicker',
                template: "<link href=\"https://fonts.googleapis.com/css?family=Material+Icons\" rel=\"stylesheet\">\r\n<input type=\"text\" (click)=\"getPosition();positionBody()\" [(ngModel)]=\"myInput\" #pickerInput />\r\n<div #pickerCompRef [ngClass]=\"{'hidePicker': hide, 'showPicker': !hide}\" class=\"suplug-container date-navigation override\">\r\n    <div (click)=\"closePicker()\" class=\"close-icon\">\r\n        <i class=\"material-icons\">clear</i>\r\n    </div>\r\n    <div class=\"navigation-pagination\">\r\n        <div class=\"left-pagination\">\r\n        <a class=\"date-navigation\" (click)=\"gotoPrevMonth();genCalendarView();\" href=\"javascript:;\"><i class=\"material-icons\">arrow_back_ios</i></a>\r\n        </div>\r\n        <div class=\"right-pagination\">\r\n            <a class=\"date-navigation\" (click)=\"gotoNextMonth();genCalendarView();\" href=\"javascript:;\"><i class=\"material-icons\">arrow_forward_ios</i></a>\r\n        </div>\r\n        <div class=\"month-navigation\">\r\n            <select (change)=\"genCalendarView()\" [(ngModel)]=\"month\">\r\n                <option *ngFor=\"let m of months\" value=\"{{m.value}}\">{{m.label}}</option>\r\n            </select>\r\n\r\n            <select class=\"date-navigation\" (change)=\"genCalendarView()\" [(ngModel)]=\"year\">\r\n                <option *ngFor=\"let y of years\" value=\"{{y}}\">{{y}}</option>\r\n            </select>\r\n        </div>  \r\n    </div>  \r\n    <table>\r\n        <tbody>\r\n            <tr>\r\n                <th *ngFor=\"let i of items\">{{i}}</th>\r\n            </tr>\r\n            <tr *ngFor=\"let weekData of dateComposer\">\r\n                <td (click)=\"onDateSelection(dayData.day)\" *ngFor=\"let dayData of weekData['week']\">\r\n                    <span *ngIf=\"dayData.day !== ''\">{{dayData.day}}</span>\r\n                </td>\r\n            </tr>\r\n        </tbody>\r\n    </table>\r\n  </div>\r\n  ",
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None,
                providers: [{
                        provide: NG_VALUE_ACCESSOR,
                        useExisting: DatepickerComponent,
                        multi: true
                    }],
                styles: [".suplug-container.hidePicker{display:none}.suplug-container .material-icons{font-size:20px}.suplug-container.showPicker{display:inline-block}.suplug-container{border:1px solid #0a99c9;padding:10px;display:inline-block;background:#efefef;position:absolute}.suplug-container td,.suplug-container th{padding:6px 0;font-size:1em}.suplug-container td span{cursor:pointer;border:1px solid transparent;padding:7px}.suplug-container td span:hover{background:#ccc;border:1px solid #000;color:#fff}.suplug-container select{padding:3px;border:0;margin-right:10px}.suplug-container .navigation-pagination{margin:10px}.suplug-container .left-pagination{float:left}.suplug-container .month-navigation{text-align:center;padding-top:3px;margin-top:21px}.suplug-container .left-pagination a,.suplug-container .right-pagination a{font-size:1em;color:#000;text-decoration:none;font-weight:700;position:relative;top:3px}.suplug-container .left-pagination a:focus{border:0}.suplug-container .right-pagination{float:right}.suplug-container .close-icon{position:absolute;top:3px;right:3px;font-size:14px;color:#000;cursor:pointer}"]
            }] }
];
/** @nocollapse */
DatepickerComponent.ctorParameters = () => [
    { type: DatepickerService },
    { type: ChangeDetectorRef }
];
DatepickerComponent.propDecorators = {
    position: [{ type: Input, args: ['position',] }],
    dateFormat: [{ type: Input, args: ['dateFormat',] }],
    onDateSelect: [{ type: Output }],
    pickerCompRef: [{ type: ViewChild, args: ['pickerCompRef',] }],
    pickerInput: [{ type: ViewChild, args: ['pickerInput',] }]
};
if (false) {
    /** @type {?} */
    DatepickerComponent.prototype.position;
    /** @type {?} */
    DatepickerComponent.prototype.dateFormat;
    /** @type {?} */
    DatepickerComponent.prototype.pickerHeight;
    /** @type {?} */
    DatepickerComponent.prototype.onDateSelect;
    /** @type {?} */
    DatepickerComponent.prototype.pickerCompRef;
    /** @type {?} */
    DatepickerComponent.prototype.pickerInput;
    /** @type {?} */
    DatepickerComponent.prototype.elementTop;
    /** @type {?} */
    DatepickerComponent.prototype.elementLeft;
    /** @type {?} */
    DatepickerComponent.prototype.inputOffset;
    /** @type {?} */
    DatepickerComponent.prototype.positioned;
    /** @type {?} */
    DatepickerComponent.prototype.hide;
    /** @type {?} */
    DatepickerComponent.prototype.items;
    /** @type {?} */
    DatepickerComponent.prototype.dateComposer;
    /** @type {?} */
    DatepickerComponent.prototype.months;
    /** @type {?} */
    DatepickerComponent.prototype.month;
    /** @type {?} */
    DatepickerComponent.prototype.year;
    /** @type {?} */
    DatepickerComponent.prototype.years;
    /** @type {?} */
    DatepickerComponent.prototype.myInput;
    /** @type {?} */
    DatepickerComponent.prototype.onChange;
    /** @type {?} */
    DatepickerComponent.prototype.onBlur;
    /** @type {?} */
    DatepickerComponent.prototype.datePickerService;
    /** @type {?} */
    DatepickerComponent.prototype.changeDetect;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0ZXBpY2tlci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9hbmdsYXItZGF0ZXBpY2tlci8iLCJzb3VyY2VzIjpbImxpYi9kYXRlcGlja2VyLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBVSxTQUFTLEVBQUUsVUFBVSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUFhLHVCQUF1QixFQUFFLGlCQUFpQixFQUFFLGlCQUFpQixFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ2hMLE9BQU8sRUFBRSxpQkFBaUIsRUFBcUMsTUFBTSxnQkFBZ0IsQ0FBQztBQUN0RixPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQWN6RCxNQUFNLE9BQU8sbUJBQW1COzs7OztJQUM5QixZQUNTLGlCQUFvQyxFQUNwQyxZQUErQjtRQUQvQixzQkFBaUIsR0FBakIsaUJBQWlCLENBQW1CO1FBQ3BDLGlCQUFZLEdBQVosWUFBWSxDQUFtQjtRQUVyQixhQUFRLEdBQVcsUUFBUSxDQUFDO1FBQzFCLGVBQVUsR0FBVyxhQUFhLENBQUM7UUFDeEQsaUJBQVksR0FBVyxHQUFHLENBQUM7UUFFakIsaUJBQVksR0FBTyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBT2hELGdCQUFXLEdBQVcsRUFBRSxDQUFDO1FBQ3pCLGVBQVUsR0FBWSxLQUFLLENBQUM7UUFFNUIsU0FBSSxHQUFZLElBQUksQ0FBQztRQVNyQixZQUFPLEdBQVEsRUFBRSxDQUFDO0lBekIwQixDQUFDOzs7O0lBNEI3QyxRQUFRO1FBQ04sSUFBSSxDQUFDLEtBQUssR0FBRyxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDO1FBQ2pELElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLGlCQUFpQixDQUFDLFNBQVMsRUFBRSxD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O0lBRUQsYUFBYTtRQUNYLElBQUksQ0FBQyxZQUFZLENBQUMsYUFBYSxFQUFFLENBQUM7SUFDcEMsQ0FBQzs7O1lBcExGLFNBQVMsU0FBQztnQkFDVCxRQUFRLEVBQUUsbUJBQW1CO2dCQUM3Qiw4NERBQTBDO2dCQUUxQyxlQUFlLEVBQUUsdUJBQXVCLENBQUMsTUFBTTtnQkFDL0MsYUFBYSxFQUFFLGlCQUFpQixDQUFDLElBQUk7Z0JBQ3JDLFNBQVMsRUFBRSxDQUFDO3dCQUNWLE9BQU8sRUFBRSxpQkFBaUI7d0JBQzFCLFdBQVcsRUFBRSxtQkFBbUI7d0JBQ2hDLEtBQUssRUFBRSxJQUFJO3FCQUNaLENBQUM7O2FBQ0g7Ozs7WUFiUSxpQkFBaUI7WUFGMEYsaUJBQWlCOzs7dUJBcUJsSSxLQUFLLFNBQUMsVUFBVTt5QkFDaEIsS0FBSyxTQUFDLFlBQVk7MkJBR2xCLE1BQU07NEJBRU4sU0FBUyxTQUFDLGVBQWU7MEJBQ3pCLFNBQVMsU0FBQyxhQUFhOzs7O0lBUHhCLHVDQUErQzs7SUFDL0MseUNBQXdEOztJQUN4RCwyQ0FBMkI7O0lBRTNCLDJDQUFnRDs7SUFFaEQsNENBQXNEOztJQUN0RCwwQ0FBa0Q7O0lBRWxELHlDQUFnQjs7SUFDaEIsMENBQWlCOztJQUNqQiwwQ0FBeUI7O0lBQ3pCLHlDQUE0Qjs7SUFFNUIsbUNBQXFCOztJQUNyQixvQ0FBVzs7SUFDWCwyQ0FBa0I7O0lBQ2xCLHFDQUFZOztJQUNaLG9DQUFjOztJQUNkLG1DQUFVOztJQUNWLG9DQUFXOztJQUdYLHNDQUFrQjs7SUFDbEIsdUNBQVM7O0lBQ1QscUNBQU87O0lBNUJMLGdEQUEyQzs7SUFDM0MsMkNBQXNDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQsIFZpZXdDaGlsZCwgRWxlbWVudFJlZiwgSW5wdXQsIE91dHB1dCwgRXZlbnRFbWl0dGVyLCBPbkRlc3Ryb3ksIENoYW5nZURldGVjdGlvblN0cmF0ZWd5LCBDaGFuZ2VEZXRlY3RvclJlZiwgVmlld0VuY2Fwc3VsYXRpb24gfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IE5HX1ZBTFVFX0FDQ0VTU09SLCBDb250cm9sVmFsdWVBY2Nlc3NvciwgRm9ybUNvbnRyb2wgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5pbXBvcnQgeyBEYXRlcGlja2VyU2VydmljZSB9IGZyb20gJy4vZGF0ZXBpY2tlci5zZXJ2aWNlJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnYW5nbGFyLWRhdGVwaWNrZXInLFxuICB0ZW1wbGF0ZVVybDogJy4vZGF0ZXBpY2tlci5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL2RhdGVwaWNrZXIuY29tcG9uZW50LnNjc3MnXSxcbiAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2gsXG4gIGVuY2Fwc3VsYXRpb246IFZpZXdFbmNhcHN1bGF0aW9uLk5vbmUsXG4gIHByb3ZpZGVyczogW3tcbiAgICBwcm92aWRlOiBOR19WQUxVRV9BQ0NFU1NPUixcbiAgICB1c2VFeGlzdGluZzogRGF0ZXBpY2tlckNvbXBvbmVudCxcbiAgICBtdWx0aTogdHJ1ZVxuICB9XVxufSlcbmV4cG9ydCBjbGFzcyBEYXRlcGlja2VyQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBDb250cm9sVmFsdWVBY2Nlc3NvciwgT25EZXN0cm95IHtcbiAgY29uc3RydWN0b3IoXG4gICAgcHVibGljIGRhdGVQaWNrZXJTZXJ2aWNlOiBEYXRlcGlja2VyU2VydmljZSxcbiAgICBwdWJsaWMgY2hhbmdlRGV0ZWN0OiBDaGFuZ2VEZXRlY3RvclJlZikgeyB9XG5cbiAgQElucHV0KCdwb3NpdGlvbicpIHBvc2l0aW9uOiBzdHJpbmcgPSAnYm90dG9tJztcbiAgQElucHV0KCdkYXRlRm9ybWF0JykgZGF0ZUZvcm1hdDogc3RyaW5nID0gJ0RELU1NTS1ZWVlZJztcbiAgcGlja2VySGVpZ2h0OiBudW1iZXIgPSA1MDA7XG5cbiAgQE91dHB1dCgpIG9uRGF0ZVNlbGVjdDphbnkgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gIFxuICBAVmlld0NoaWxkKCdwaWNrZXJDb21wUmVmJykgcGlja2VyQ29tcFJlZjogRWxlbWVudFJlZjtcbiAgQFZpZXdDaGlsZCgncGlja2VySW5wdXQnKSBwaWNrZXJJbnB1dDogRWxlbWVudFJlZjtcbiAgXG4gIGVsZW1lbnRUb3A6IGFueTtcbiAgZWxlbWVudExlZnQ6IGFueTtcbiAgaW5wdXRPZmZzZXQ6IG51bWJlciA9IDI2O1xuICBwb3NpdGlvbmVkOiBib29sZWFuID0gZmFsc2U7XG5cbiAgaGlkZTogYm9vbGVhbiA9IHRydWU7XG4gIGl0ZW1zOiBhbnk7XG4gIGRhdGVDb21wb3NlcjogYW55O1xuICBtb250aHM6IGFueTtcbiAgbW9udGg6IG51bWJlcjtcbiAgeWVhcjogYW55O1xuICB5ZWFyczogYW55O1xuXG5cbiAgbXlJbnB1dDogYW55ID0gJyc7XG4gIG9uQ2hhbmdlO1xuICBvbkJsdXI7XG4gIG5nT25Jbml0KCkge1xuICAgIHRoaXMuaXRlbXMgPSBbJ1MnLCAnTScsICdUJywgJ1cnLCAnVCcsICdGJywgJ1MnXTtcbiAgICB0aGlzLm1vbnRocyA9IHRoaXMuZGF0ZVBpY2tlclNlcnZpY2UuZ2V0TW9udGhzKCk7XG4gICAgdGhpcy55ZWFycyA9IHRoaXMuZGF0ZVBpY2tlclNlcnZpY2UuZ2V0WWVhcnMoKTtcbiAgICB0aGlzLnllYXIgPSB0aGlzLmRhdGVQaWNrZXJTZXJ2aWNlLmdldFllYXIoKTtcbiAgICB0aGlzLm1vbnRoID0gdGhpcy5kYXRlUGlja2VyU2VydmljZS5nZXRNb250aCgpO1xuICAgIHRoaXMuZ2VuQ2FsZW5kYXJWaWV3KCk7XG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0aGlzLnBpY2tlckNvbXBSZWYubmF0aXZlRWxlbWVudCk7XG4gICAgdGhpcy5kZXRlY3RDaGFuZ2VzKCk7XG4gIH1cblxuICBwb3NpdGlvbkJvZHkoKSB7XG4gICAgaWYoIXRoaXMucG9zaXRpb25lZCkge1xuICAgICAgdGhpcy5wb3NpdGlvbkVsZW1lbnQoKTtcbiAgICB9XG4gICAgdGhpcy5vcGVuUGlja2VyKCk7XG4gIH1cblxuICAvKipcbiAgICogVGhpcyBpcyB3aGVyZSB0aGUgdmFsdWVzIHVwZGF0ZWQgaW4gdmlldyBpbiBwYXJlbnQgY29tcG9uZW50IGdldHMgdXBkYXRlZCBpbiB0aGUgY2hpbGQgY29tcG9uZW50IGhlcmVcbiAgICogQHBhcmFtIG15SW5wdXQgXG4gICAqL1xuICB3cml0ZVZhbHVlKG15SW5wdXQ6IGFueSk6IHZvaWQge1xuICAgIHRoaXMubXlJbnB1dCA9IG15SW5wdXQ7XG4gICAgdGhpcy5kZXRlY3RDaGFuZ2VzKCk7XG4gIH1cblxuICByZWdpc3Rlck9uQ2hhbmdlKGZuOiBhbnkpOiB2b2lkIHtcbiAgICB0aGlzLm9uQ2hhbmdlID0gZm47XG4gIH1cblxuICByZWdpc3Rlck9uVG91Y2hlZChmbjogYW55KTogdm9pZCB7XG4gICAgdGhpcy5vbkJsdXIgPSBmbjtcbiAgfVxuXG4gIHBvc2l0aW9uRWxlbWVudCgpIHtcbiAgICBsZXQgZHJvcGRvd25JdGVtID0gdGhpcy5waWNrZXJDb21wUmVmLm5hdGl2ZUVsZW1lbnQ7XG4gICAgZHJvcGRvd25JdGVtWydzdHlsZSddWyd0b3AnXSA9IHRoaXMuZWxlbWVudFRvcCArICdweCc7XG4gICAgZHJvcGRvd25JdGVtWydzdHlsZSddWydsZWZ0J10gPSB0aGlzLmVsZW1lbnRMZWZ0ICsgJ3B4JztcbiAgICB0aGlzLnBvc2l0aW9uZWQgPSB0cnVlO1xuICB9XG5cbiAgZ2V0UG9zaXRpb24oKSB7XG4gICAgbGV0IHJlY3QgPSB0aGlzLnBpY2tlcklucHV0Lm5hdGl2ZUVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgbGV0IHNjcm9sbFRvcCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3AgP1xuICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCA6IGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wO1xuICAgIGxldCBzY3JvbGxMZWZ0ID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbExlZnQgP1xuICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbExlZnQgOiBkb2N1bWVudC5ib2R5LnNjcm9sbExlZnQ7XG4gICAgdGhpcy5lbGVtZW50VG9wID0gcmVjdC50b3AgKyBzY3JvbGxUb3A7XG4gICAgdGhpcy5lbGVtZW50TGVmdCA9IHJlY3QubGVmdCArIHNjcm9sbExlZnQ7XG4gICAgc3dpdGNoKHRoaXMucG9zaXRpb24pIHtcbiAgICAgIGNhc2UgJ2xlZnQnOlxuICAgICAgICB0aGlzLmVsZW1lbnRMZWZ0IC09IDMwMDtcbiAgICAgICAgdGhpcy5lbGVtZW50VG9wIC09IHRoaXMuaW5wdXRPZmZzZXQgLSAyMDtcbiAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAncmlnaHQnOlxuICAgICAgICB0aGlzLmVsZW1lbnRMZWZ0ICs9IDIwMDtcbiAgICAgICAgdGhpcy5lbGVtZW50VG9wIC09IHRoaXMuaW5wdXRPZmZzZXQgLSAyMDtcbiAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAndG9wJzpcbiAgICAgICAgdGhpcy5lbGVtZW50VG9wIC09IDI3MztcbiAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnYm90dG9tJzpcbiAgICAgIGRlZmF1bHQ6XG4gICAgICB0aGlzLmVsZW1lbnRUb3AgKz0gdGhpcy5pbnB1dE9mZnNldDtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuXG4gIG5nT25EZXN0cm95KCkge1xuICAgIHRoaXMucGlja2VyQ29tcFJlZi5uYXRpdmVFbGVtZW50Lm91dGVySFRNTCA9ICcnO1xuICB9XG5cbiAgb25EYXRlU2VsZWN0aW9uKGRheTogYW55KSB7XG4gICAgaWYoZGF5IDwgMTApIHtcbiAgICAgIGRheSA9ICcwJytkYXk7XG4gICAgfVxuICAgIGxldCBtb250aDogYW55ID0gdGhpcy5tb250aDtcbiAgICBpZih0aGlzLm1vbnRoIDwgMTApIHtcbiAgICAgIG1vbnRoID0gJzAnK3RoaXMubW9udGg7XG4gICAgfVxuICAgIGxldCBzZWxlY3RlZERhdGUgPSB0aGlzLnllYXIgKyAnLScgKyBtb250aCArICctJyArIGRheTtcbiAgICBsZXQgZGF0ZU9iaiA9ICB7XG4gICAgICBmb3JtYXR0ZWREYXRlOiB0aGlzLmRhdGVQaWNrZXJTZXJ2aWNlLmdldERhdGVGb3JtYXR0ZWQoc2VsZWN0ZWREYXRlLCB0aGlzLmRhdGVGb3JtYXQpLFxuICAgICAgZGF0ZU9iamVjdDogdGhpcy5kYXRlUGlja2VyU2VydmljZS5nZXREYXRlTW9tZW50KHNlbGVjdGVkRGF0ZSlcbiAgICB9O1xuICAgIHRoaXMubXlJbnB1dCA9IGRhdGVPYmouZm9ybWF0dGVkRGF0ZTtcbiAgICB0aGlzLm9uQ2hhbmdlKHRoaXMubXlJbnB1dCk7XG4gICAgdGhpcy5vbkRhdGVTZWxlY3QuZW1pdChkYXRlT2JqLmRhdGVPYmplY3QpO1xuICAgIHRoaXMuY2xvc2VQaWNrZXIoKTtcbiAgfVxuXG4gIGdlbkNhbGVuZGFyVmlldygpIHtcbiAgICB0cnkge1xuICAgICAgbGV0IHN0YXJ0RGF5ID0gdGhpcy5kYXRlUGlja2VyU2VydmljZS5nZW5lcmF0ZU1vbnRoRGF0ZSh0aGlzLm1vbnRoLCB0aGlzLnllYXIpO1xuICAgICAgbGV0IGxhc3REYXkgPSB0aGlzLmRhdGVQaWNrZXJTZXJ2aWNlLmdldE1vbnRoRGF0ZXModGhpcy5tb250aCwgdGhpcy55ZWFyKTtcbiAgICAgIHRyeSB7XG4gICAgICAgIHRoaXMuZGF0ZUNvbXBvc2VyID0gdGhpcy5kYXRlUGlja2VyU2VydmljZS5kYXRlQ29tcG9zZXIoc3RhcnREYXksIGxhc3REYXkpO1xuICAgICAgICB0aGlzLmRldGVjdENoYW5nZXMoKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGUpO1xuICAgIH1cbiAgfVxuXG4gIGdvdG9QcmV2TW9udGgoKSB7XG4gICAgaWYoIE51bWJlcih0aGlzLm1vbnRoKSA9PT0gMSkge1xuICAgICAgICB0aGlzLm1vbnRoID0gMTI7XG4gICAgICAgIHRoaXMueWVhci0tO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLm1vbnRoLS07XG4gICAgfSAgICBcbiAgfVxuXG4gIGdvdG9OZXh0TW9udGgoKSB7XG4gICAgaWYoIE51bWJlcih0aGlzLm1vbnRoKSA9PT0gMTIpIHtcbiAgICAgICAgdGhpcy5tb250aCA9IDE7XG4gICAgICAgIHRoaXMueWVhcisrO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLm1vbnRoKys7XG4gICAgfVxuICB9XG5cbiAgb3BlblBpY2tlcigpIHtcbiAgICB0aGlzLmhpZGUgPSBmYWxzZTtcbiAgICB0aGlzLmRldGVjdENoYW5nZXMoKTtcbiAgfVxuXG4gIGNsb3NlUGlja2VyKCkge1xuICAgIHRoaXMuaGlkZSA9IHRydWU7XG4gICAgdGhpcy5kZXRlY3RDaGFuZ2VzKCk7XG4gIH1cblxuICBkZXRlY3RDaGFuZ2VzKCkge1xuICAgIHRoaXMuY2hhbmdlRGV0ZWN0LmRldGVjdENoYW5nZXMoKTtcbiAgfVxuXG59XG4iXX0=